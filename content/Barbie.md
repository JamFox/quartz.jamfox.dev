The movie is primarily about men — how their insecurities manifest as overcompensation, how they value themselves in relation to women (and their validation), and how the patriarchy is caused by the combination of these two things. 
Ken is defined by his relationship or his job (even if it's just "beach") both in fantasy Barbie Land or the patriarchical real world, and he finds in the real world that unless he's at the top of the heap, he won't find a job/definition that gives him any value.

"I am Ken?" Before all, be yourself. Find what it means to be Ken. Only then can you find the source of your jealousy for other Ken. Only after, can you find your Barbie. The message of you don't need to (not even supposed to) rely on someone for your happiness is important and anyone can agree with that.
The horses, trucks, gym, high heels, cellulite free skin - the ego.
You can only be Kenough when you find approval within yourself not from others.
And even then the world will hate you. But in that hate, there will be beauty right next to it and you will have the opportunity to *choose* to look at the hate or beauty.
But is this the only commitment the movie makes? Too complex for a child audience, too simplified to be an actual effective message, and too cynical to be of any use anyway? Or meant as a jumping point for the general audience: spray and pray?

The justification for Barbieland not becoming totally equal was that, unlike IRL men, all the Kens were 100% himbos. You wouldn't want a himbo President or lawyer or whatever. So the Barbies acknowledging they need to pay attention more to the Kens' feelings, without actually giving them any major power, _is_ an equal society for Barbieland.
The problem with this is we know that in the real world women weren't inferior but were simply oppressed by men, but in Barbieland the message is that men are inherently (genetically) inferior which actually gives the Barbies a twisted justification to oppress them; they can't ever be truly equal because they aren't born equal, the men's natural incompetence at everything would hold their entire society back if they were egalitarian.
While defining yourself by your relationships is a toxic and unhealthy thing to do in the real world, in Barbieland the Kens (and by extension Allan) literally have nothing else. So when Ken finds a misguided interest in "patriarchy" (which he admits he thought was mostly about horses), he tries to express his interests and share them with the other Kens. These interests range from male bonding, sports, film (see: _The Godfather_ scene), and horse riding to pollution, stealing property, and brainwashing. All of these are then condemned by the film as being "patriarchy" and needs fixing, rather than just the destructive elements.
"Where do the Kens live?"
But in a way the equal resolution was represented when Barbie apologized to Ken for having too many girl nights.
Although in some sense it doesn't come from the "Kens shouldn't have Supreme Court positions because they're dumb" part (just a surface level joke?).
The parallel is "women are allowed to define themselves by their goals and aspirations (President Barbie, Doctor Barbie, etc.) while men are told to tie their self-worth primarily to female validation (Kens are all named the same, despite having differences, because they're all defined by their need for Barbies' attention). The point was that men are also hurt by the patriarchy and that our society doesn't address it.
Instead of acknowledging all the progress towards equality today, the movie dismisses all the positive changes as "it's the same but we can just hide it better".
Instead of pretending all the problems are Barbieland are solved, it shows they still have more work to do.

What ending does Allan get?
Allan knew who he was, even though he wasn't the happiest of people, he knew who he was.
Easier to wave off men and focus on the female perspective?
The films ends with the Barbies recreating the exact same system under which they had already been living.

_“I want to do the imagining, I don’t want to be the idea.”_
The first thing after deciding to find yourself is to go to the gynecologist?

Barbie will genuinely be a movie that is studied in business schools. Anyone who is saying “I can’t believe Mattel let them get away with this!” and anyone who finds this movie to be anti-capitalist totally got duped by the genius marketing that Mattel delivers here.
Barbie does indeed feel like an antiquated (but somewhat loving) attempt at trying to inspire women of the time.
